<html>
	<head>
		<title>execute method</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="w3.css">
		<script src="test_neighbors.js"></script>
		<script src="setOps.js"></script>
		<script src="graphClass.js"></script>
		<script src="reposts.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	</head>

	<body>

		<div class="w3-card-4 w3-display-middle w3-white w3-border w3-border-blue w3-round-xlarge" style="display:block;z-index:1" id="card">
 
               <header class="w3-container">
                 <h5 id="welcome" style="padding=30px"></h5>
               </header>
               <div class="w3-container" id="progressContainer">
               	<button class="w3-btn-block w3-hover-blue w3-border w3-border-red w3-white" style="width:90%" onclick="mass_friend_list()">go</button></br>
               </div>
               <footer class="w3-container">
                 <h5 id="friendList"></h5>
                <p id="p"></p>
             </footer>
               </div>
 
 
       </div>
	</body>
<script type="text/javascript">
friends = [350154,394886,556223,738666,773832,926738,1003122,1216918,1510504,1519591,1631232,1687214,1737958,2044278,2063101,2131567,2275185,2347929,2487316,2748636,3331912,3423078,3429412,3508182,3837651,4670674,5068884,5195606,5384114,5434473,5496957,5536630,5546300,5617086,5656370,5704587,5736717,6003338,6131566,6311151,6497155,6639829,7042580,7154404,7207349,7654548,7859358,7974062,8332537,8414712,8452203,8981020,9204448,9282858,9385891,9509752,9519338,9894262,10208561,10275196,10570999,11415861,11698049,11858115,12608114,13098735,13112302,13568264,13676838,13693239,14059446,14412167,14412688,14464066,15174186,15812237,16060946,16081499,16311296,16462789,16723059,16859494,17246399,17270352,17288767,17303442,17437334,17595469,17642862,17709584,18062145,18181351,18446921,18517863,18672426,18721657,19070928,19085852,19121706,19420835,19589139,19625346,19789747,19849069,19905195,20050753,20613467,20816045,21075080,21123248,21854313,22019656,22286780,22589618,23024333,23029427,23739283,24130339,24637377,24680395,25017450,25067075,25629649,25637350,26806769,27096846,28122534,28263094,28392974,28488309,28835427,30175870,30422614,30878412,31322557,31856149,31868065,32171817,32521578,33807883,33984601,34225288,34615307,34651497,34881474,34956520,35110445,35113201,35469410,35608847,37639341,37646294,38067042,38256906,39029344,41370243,42348445,42707731,43545872,43614951,45262785,45625659,46088408,46165884,46405937,47063878,48777993,49336912,49512302,49629227,49702254,50703262,52488202,52528379,52790706,52829674,53348785,53377458,53772254,54631134,54801999,55522846,57808345,58251196,59275988,62249036,62454093,62822290,64006742,65804184,65874306,66031779,67451031,68698612,68892601,69048947,69124781,70065924,70078053,70129023,71843998,77349090,77674391,77733615,82668898,83228639,83408415,84135825,85301413,86464350,87300840,87504909,88023674,88598011,89360103,89758952,91057277,91810942,91829479,91937767,92181959,94318267,96246725,96425492,97340585,97935185,99415811,99450892,99523175,99783474,101064249,101129329,101730242,102718270,102881938,107513565,109130653,109376154,110517057,111914147,112208318,117664186,120120210,120786592,121157665,122556160,123732071,125640369,126412770,126953256,127737054,131501631,132805537,133714590,134630414,134988561,135529626,135807036,136914976,137016788,137358760,138808200,138916239,139137603,139309621,139922426,140968298,141515842,141579810,142323784,143601443,143775640,143818487,144021506,144074986,144882360,144977512,145083488,145288668,145865352,146136794,146654728,147897133,149969296,150387774,151205550,152518083,152600384,152713367,153152361,153204475,153473645,153651608,153885357,154486979,155287838,157347058,158113142,158189797,158336960,158724011,159870304,160040903,161004005,162555837,162926783,162974393,163616940,165721123,169198648,169218273,170598637,171813876,172382844,173558868,175548605,175698332,176229022,176282835,179260834,179979765,180709340,181840046,181847330,181901208,182265632,182366765,183397530,183603812,183871035,183878995,183989677,184275219,184376086,184562970,184606339,185398807,185592973,186048850,186390905,186802894,187508234,188318824,188852970,189281391,189575193,190159535,190165983,190710569,190786784,192301783,193319042,194430550,197531371,200250816,200831611,201576289,201673127,202159778,202568507,203566805,204373645,205724568,206373419,208193141,208474788,209210274,209633643,210878159,210893279,211415724,211563756,212625720,214401415,214422684,215310903,216872143,217128659,217471742,218663295,219115985,219221610,219382506,221326536,221377327,221644626,222275053,222509988,223624286,223775121,224370899,224411184,224460659,224550124,225056283,225339184,225492399,225514646,225631173,226128012,226633539,226931874,227125030,227166441,228452471,228928880,230747354,232634199,233387883,233835210,233859323,234159927,234692364,234825671,234838159,235224948,236699417,238082417,239772099,242137431,242706300,243928949,244255706,244366897,245382577,254639532,256018279,259824215,259971489,260011279,260551715,261832650,263413897,265814811,268036779,268920325,268971041,269052730,269243892,269290813,271626356,273848330,277031753,278315501,280180694,282316100,287222546,289475633,290421841,291353739,294503814,294548783,294650354,294724514,295663634,298116264,298737461,299058607,301700636,310400479,311375821,314188301,314419834,315134112,318824410,323338228,324271849,324862858,326579123,326914680,328087967,332896447,334160186,335684475,337228384,341509243,346014843,350788403,355065657,355667668,358408755,364350915,374259460,375927259,380439241,385148143,390813544,400491970,400692982]


function mass_friend_list(code,friend_dict,iteration){
	access_token = "8d513944dd4c165d0dc5d0985e80a2bbe8e8f447ebe84436e5671985be4b7f2a51aad354a59dcce0cce96"
	var query = `https://api.vk.com/method/execute?access_token=${access_token}&code=${code}`;
	setTimeout(function(){
		$.get(query, function(data, status){ 
			for (var friend in data.response){
				
				if (data.response[friend] == false){
					// console.log("response",data,status);

					delete data.response[friend];
				}
			}

		 	$.extend(friend_dict, data.response)
		})
	},330*iteration);
}
function build_query(friends){
	// console.log(friends)
	var first = friends.pop();
	var code_block = `return{"${first}": API.friends.get({"uid":${first}})`
	for (var i in friends) {
		code_block += `,"${friends[i]}": API.friends.get({"uid":${friends[i]}})`
		};
	code_block += "};"
	return code_block
}


nodes_to_friends = {}
splice_dict = {}
var splices=0
while (friends.length>0){
	splice_dict[splices] = friends.splice(0,25);
	splices++;
}

for (var i = 0; i < splices; i++) {
	    mass_friend_list(build_query(splice_dict[i]),nodes_to_friends,i);
};


setTimeout(function(){
			console.log(nodes_to_friends);
  },3000);

</script>




